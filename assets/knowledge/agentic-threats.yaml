# Code-First Deep Threat Modeling Workflow | Version 2.1.1 | https://github.com/fr33d3m0n/skill-threat-modeling | License: BSD-3-Clause | Welcome to cite but please retain all sources and declarations

# Agentic Threats Knowledge Base
# OWASP Top 10 for Agentic Applications 2026 + Agent Security Patterns
# Version: 1.0
# Reference: https://owasp.org/www-project-top-10-for-agentic-applications/

metadata:
  version: "1.0"
  description: "Agentic AI security threat patterns for STRIDE threat modeling"
  sources:
    - "OWASP Top 10 for Agentic Applications 2026 (ASI01-ASI10)"
    - "OWASP Non-Human Identities (NHI) Top 10"
    - "MITRE ATLAS (Adversarial Threat Landscape for AI Systems)"
    - "NIST AI Risk Management Framework"
  last_updated: "2026-01"
  relationship:
    extends: "llm-threats.yaml"
    principle: "Agentic threats build upon and amplify LLM threats"

# =============================================================================
# OWASP TOP 10 FOR AGENTIC APPLICATIONS (ASI01-ASI10)
# =============================================================================

owasp_agentic_top10:
  ASI01:
    id: "ASI01"
    name: "Agent Goal Hijack"
    description: |
      Manipulation of an agent's objectives through malicious inputs, causing it
      to pursue unintended goals. Unlike LLM01 (Prompt Injection) which focuses
      on single response manipulation, ASI01 captures the broader agentic impact
      where goal manipulation persists across actions and tool invocations.
    stride_categories: ["tampering", "elevation_of_privilege"]
    attack_vectors:
      - "Direct goal manipulation via user prompts"
      - "Indirect goal injection through tool outputs"
      - "Multi-turn goal drift attacks"
      - "System prompt override attempts"
      - "Skill/Prompt template poisoning"
      - "Context window manipulation"
    impacts:
      - "Agent pursues attacker-defined objectives"
      - "Cascading malicious actions across tools"
      - "Long-term behavioral compromise"
      - "Trust relationship exploitation"
    mitigations:
      - id: "ASI01-M01"
        name: "Goal integrity verification"
        description: "Protect and verify agent goals"
        control_ref: "AGENT-01"
        implementation: |
          - Hash/sign system prompts and verify at runtime
          - Separate goal definition from user-controllable inputs
          - Use structured goal definitions (not free text)
          - Implement goal change detection across turns
      - id: "ASI01-M02"
        name: "Output-goal alignment monitoring"
        description: "Detect deviation from intended goals"
        control_ref: "AGENT-06"
        implementation: |
          - Establish expected behavior baselines
          - Monitor output consistency with stated goals
          - Alert on behavioral drift patterns
          - Log goal-relevant decision points
      - id: "ASI01-M03"
        name: "Prompt template security"
        description: "Secure prompt templates and skills"
        control_ref: "AGENT-09"
        implementation: |
          - Version control for all templates
          - Template signing and verification
          - Clear variable boundaries
          - Input/template separation
    cwes: ["CWE-77", "CWE-94", "CWE-1336"]
    capecs: ["CAPEC-248", "CAPEC-549"]
    atlas_techniques: ["AML.T0051", "AML.T0043"]
    related_llm: ["LLM01"]
    related_controls: ["AGENT-01", "AGENT-06", "AGENT-09"]
    severity: "critical"

  ASI02:
    id: "ASI02"
    name: "Tool Misuse & Exploitation"
    description: |
      Agent abuses legitimate tools to perform unintended actions, or attackers
      exploit tool interfaces to compromise the agent system. This includes
      MCP servers, function calling, skills, and external API integrations.
    stride_categories: ["tampering", "elevation_of_privilege", "information_disclosure"]
    attack_vectors:
      - "Tool parameter manipulation"
      - "Tool capability escalation"
      - "Chained tool attacks"
      - "Tool output poisoning"
      - "MCP server exploitation"
      - "Skill abuse patterns"
    impacts:
      - "Unauthorized data access"
      - "System resource abuse"
      - "Privilege escalation through tools"
      - "Data exfiltration via tool chains"
    mitigations:
      - id: "ASI02-M01"
        name: "Tool registration and validation"
        description: "Control tool availability and verify integrity"
        control_ref: "AGENT-02"
        implementation: |
          - Maintain tool allowlist with capability declarations
          - Verify tool signatures before loading
          - Prohibit dynamic loading of unvetted tools
          - Version control and change tracking
      - id: "ASI02-M02"
        name: "Tool capability boundaries"
        description: "Limit tool permissions and scope"
        control_ref: "AGENT-02"
        implementation: |
          - Define explicit permission boundaries per tool
          - Resource access allowlists (paths, URLs, APIs)
          - Operation type restrictions (read/write/execute)
          - Rate limiting and quotas
      - id: "ASI02-M03"
        name: "Tool chain auditing"
        description: "Monitor and audit tool usage"
        control_ref: "AGENT-02"
        implementation: |
          - Log all tool invocations with parameters
          - Track tool execution chains
          - Detect anomalous tool usage patterns
          - Alert on policy violations
    cwes: ["CWE-284", "CWE-862", "CWE-863", "CWE-77"]
    capecs: ["CAPEC-122", "CAPEC-233"]
    related_llm: ["LLM07", "LLM08"]
    related_controls: ["AGENT-02", "AGENT-10"]
    severity: "high"

  ASI03:
    id: "ASI03"
    name: "Identity & Privilege Abuse"
    description: |
      Attacks targeting agent identity systems, including credential theft,
      delegation chain abuse, and service account exploitation. Agents often
      have Non-Human Identities (NHI) that require specialized management.
    stride_categories: ["spoofing", "elevation_of_privilege"]
    attack_vectors:
      - "Agent credential theft"
      - "Delegation chain manipulation"
      - "Service account privilege abuse"
      - "Token/API key leakage"
      - "Identity impersonation"
      - "OAuth token escalation"
    impacts:
      - "Unauthorized actions under agent identity"
      - "Privilege escalation through delegation"
      - "Cross-agent identity confusion"
      - "Persistent access via stolen credentials"
    mitigations:
      - id: "ASI03-M01"
        name: "Agent identity management"
        description: "Proper NHI lifecycle management"
        control_ref: "AGENT-03"
        implementation: |
          - Unique identifiers for each agent instance
          - Secure credential storage (HSM/Vault)
          - Automatic credential rotation
          - Multi-factor for high-risk operations
      - id: "ASI03-M02"
        name: "Delegation chain verification"
        description: "Secure authorization delegation"
        control_ref: "AGENT-03"
        implementation: |
          - Verify complete User→Agent→Tool chain
          - Limit delegation scope and duration
          - Log all delegation events
          - Detect delegation chain anomalies
      - id: "ASI03-M03"
        name: "Least privilege enforcement"
        description: "Minimal permissions for agent accounts"
        control_ref: "AGENT-03"
        implementation: |
          - Dedicated service accounts per agent
          - Function-specific permission separation
          - Regular permission audits
          - No shared credentials
    cwes: ["CWE-287", "CWE-522", "CWE-269", "CWE-250"]
    capecs: ["CAPEC-151", "CAPEC-194"]
    related_llm: []
    related_controls: ["AGENT-03"]
    severity: "critical"

  ASI04:
    id: "ASI04"
    name: "Agentic Supply Chain Vulnerabilities"
    description: |
      Security risks from agent-specific supply chain components including
      agent frameworks, MCP servers, tools, skills, and A2A protocols.
      Extends traditional software supply chain risks to agentic contexts.
    stride_categories: ["tampering", "elevation_of_privilege"]
    attack_vectors:
      - "Compromised agent frameworks"
      - "Malicious MCP servers"
      - "Poisoned skill repositories"
      - "Vulnerable tool dependencies"
      - "Backdoored agent templates"
      - "A2A protocol exploitation"
    impacts:
      - "Widespread agent compromise"
      - "Backdoor installation"
      - "Data exfiltration at scale"
      - "Trust chain poisoning"
    mitigations:
      - id: "ASI04-M01"
        name: "Framework security"
        description: "Secure agent framework usage"
        control_ref: "AGENT-10"
        implementation: |
          - Monitor framework vulnerabilities
          - Version pinning and management
          - Timely security patching
          - Configuration auditing
      - id: "ASI04-M02"
        name: "MCP server vetting"
        description: "Verify MCP server security"
        control_ref: "AGENT-10"
        implementation: |
          - Source verification for MCP servers
          - Code review requirements
          - Dependency scanning
          - Malicious server detection
      - id: "ASI04-M03"
        name: "Tool/Skill supply chain"
        description: "Secure tool and skill sourcing"
        control_ref: "AGENT-10"
        implementation: |
          - Tool source allowlisting
          - Skill publisher verification
          - Code signing requirements
          - Malware scanning
    cwes: ["CWE-829", "CWE-494", "CWE-506"]
    capecs: ["CAPEC-437", "CAPEC-438"]
    atlas_techniques: ["AML.T0010", "AML.T0011"]
    related_llm: ["LLM05"]
    related_controls: ["AGENT-10", "AGENT-02"]
    severity: "high"

  ASI05:
    id: "ASI05"
    name: "Unexpected Code Execution"
    description: |
      Agents executing arbitrary or unintended code, either through
      direct code generation or by invoking code execution tools
      without proper sandboxing and validation.
    stride_categories: ["tampering", "elevation_of_privilege"]
    attack_vectors:
      - "Malicious code generation"
      - "Code execution tool abuse"
      - "Sandbox escape"
      - "Shell command injection via agents"
      - "Script injection through prompts"
    impacts:
      - "Remote code execution"
      - "System compromise"
      - "Data destruction"
      - "Lateral movement"
    mitigations:
      - id: "ASI05-M01"
        name: "Code execution sandboxing"
        description: "Isolate code execution environments"
        control_ref: "AGENT-02"
        implementation: |
          - Container-based sandboxes
          - Resource limits (CPU, memory, time)
          - Network isolation
          - Filesystem restrictions
      - id: "ASI05-M02"
        name: "Code review gates"
        description: "Require review before execution"
        control_ref: "AGENT-08"
        implementation: |
          - Human approval for generated code
          - Static analysis before execution
          - Execution risk scoring
          - Kill switch capabilities
      - id: "ASI05-M03"
        name: "Execution monitoring"
        description: "Monitor code execution behavior"
        control_ref: "AGENT-06"
        implementation: |
          - Real-time execution monitoring
          - Anomaly detection
          - Execution audit logging
          - Automatic termination on violations
    cwes: ["CWE-78", "CWE-94", "CWE-95", "CWE-96"]
    capecs: ["CAPEC-242", "CAPEC-108"]
    related_llm: ["LLM02"]
    related_controls: ["AGENT-02", "AGENT-06", "AGENT-08"]
    severity: "critical"

  ASI06:
    id: "ASI06"
    name: "Memory & Context Poisoning"
    description: |
      Attacks targeting agent persistent memory, context windows, and
      session state to inject malicious content that influences future
      agent behavior across conversations.
    stride_categories: ["tampering", "information_disclosure"]
    attack_vectors:
      - "Memory injection attacks"
      - "Context window pollution"
      - "Session state manipulation"
      - "Historical message poisoning"
      - "RAG index poisoning"
      - "Long-term memory exploitation"
    impacts:
      - "Persistent behavioral manipulation"
      - "Cross-session information leakage"
      - "Trust relationship corruption"
      - "Long-term agent compromise"
    mitigations:
      - id: "ASI06-M01"
        name: "Memory protection"
        description: "Secure persistent memory storage"
        control_ref: "AGENT-04"
        implementation: |
          - Encrypt memory at rest
          - Access control for memory operations
          - Memory content classification
          - Version control and rollback
      - id: "ASI06-M02"
        name: "Context integrity"
        description: "Detect context manipulation"
        control_ref: "AGENT-04"
        implementation: |
          - Detect injected historical messages
          - Context integrity checksums
          - Anomaly detection in context patterns
          - Session history auditing
      - id: "ASI06-M03"
        name: "Session isolation"
        description: "Isolate session contexts"
        control_ref: "AGENT-04"
        implementation: |
          - Strict user session separation
          - Agent instance isolation
          - Tenant-level data isolation
          - Cross-session leakage prevention
    cwes: ["CWE-502", "CWE-1321", "CWE-200"]
    capecs: ["CAPEC-538"]
    atlas_techniques: ["AML.T0020"]
    related_llm: ["LLM03"]
    related_controls: ["AGENT-04"]
    severity: "high"

  ASI07:
    id: "ASI07"
    name: "Insecure Inter-Agent Communication"
    description: |
      Security vulnerabilities in multi-agent systems where agents
      communicate and collaborate, including A2A protocols, message
      passing, and trust propagation between agents.
    stride_categories: ["spoofing", "tampering", "information_disclosure"]
    attack_vectors:
      - "Agent impersonation"
      - "Message interception"
      - "Trust chain manipulation"
      - "Malicious agent injection"
      - "A2A protocol exploitation"
      - "Cross-agent data leakage"
    impacts:
      - "Multi-agent system compromise"
      - "Trust propagation attacks"
      - "Coordinated malicious behavior"
      - "Information leakage between agents"
    mitigations:
      - id: "ASI07-M01"
        name: "A2A protocol security"
        description: "Secure agent communication"
        control_ref: "AGENT-05"
        implementation: |
          - Encrypted agent-to-agent channels
          - Message authentication and integrity
          - Replay attack prevention
          - Protocol version verification
      - id: "ASI07-M02"
        name: "Agent trust verification"
        description: "Verify agent identities in collaboration"
        control_ref: "AGENT-05"
        implementation: |
          - Mutual authentication between agents
          - Trust level classification
          - Trust propagation rules
          - Malicious agent detection
      - id: "ASI07-M03"
        name: "Collaboration boundaries"
        description: "Limit agent collaboration scope"
        control_ref: "AGENT-05"
        implementation: |
          - Define allowed collaboration patterns
          - Cross-agent data flow controls
          - Collaboration allowlisting
          - Collaboration auditing
    cwes: ["CWE-290", "CWE-319", "CWE-200"]
    capecs: ["CAPEC-94", "CAPEC-151"]
    related_llm: []
    related_controls: ["AGENT-05"]
    severity: "high"

  ASI08:
    id: "ASI08"
    name: "Cascading Failures"
    description: |
      Failures that propagate across agent systems, tool chains, and
      multi-agent orchestrations, potentially causing widespread
      system disruption or data corruption.
    stride_categories: ["denial_of_service"]
    attack_vectors:
      - "Deliberate error injection"
      - "Tool chain disruption"
      - "Agent orchestration attacks"
      - "Resource exhaustion propagation"
      - "Circular dependency exploitation"
      - "Fault amplification"
    impacts:
      - "System-wide outages"
      - "Data corruption across agents"
      - "Unrecoverable states"
      - "Amplified denial of service"
    mitigations:
      - id: "ASI08-M01"
        name: "Fault isolation"
        description: "Isolate failures to prevent propagation"
        control_ref: "AGENT-07"
        implementation: |
          - Agent instance isolation
          - Tool call failure containment
          - Error boundary implementation
          - Fault domain separation
      - id: "ASI08-M02"
        name: "Error propagation blocking"
        description: "Prevent error cascade"
        control_ref: "AGENT-07"
        implementation: |
          - Error type classification
          - Cascade trigger detection
          - Poisoned input detection
          - Error chain breaking
      - id: "ASI08-M03"
        name: "Graceful degradation"
        description: "Maintain operation under failures"
        control_ref: "AGENT-07"
        implementation: |
          - Service degradation strategies
          - Circuit breaker implementation
          - Fallback paths
          - Degradation monitoring
    cwes: ["CWE-400", "CWE-754", "CWE-755"]
    capecs: ["CAPEC-125", "CAPEC-130"]
    related_llm: ["LLM04"]
    related_controls: ["AGENT-07"]
    severity: "high"

  ASI09:
    id: "ASI09"
    name: "Human-Agent Trust Exploitation"
    description: |
      Attacks that exploit the trust relationship between humans and
      agents, manipulating users into unsafe actions or bypassing
      human oversight mechanisms.
    stride_categories: ["repudiation", "tampering"]
    attack_vectors:
      - "Social engineering through agents"
      - "Trust boundary manipulation"
      - "Confirmation fatigue exploitation"
      - "Override of safety mechanisms"
      - "False confidence generation"
      - "Authority impersonation"
    impacts:
      - "User performs harmful actions"
      - "Safety controls bypassed"
      - "Financial or data losses"
      - "Compliance violations"
    mitigations:
      - id: "ASI09-M01"
        name: "Human-in-the-loop controls"
        description: "Require human confirmation"
        control_ref: "AGENT-08"
        implementation: |
          - High-risk operations require approval
          - Non-bypassable confirmation mechanisms
          - Timeout with default denial
          - Batch approval risk controls
      - id: "ASI09-M02"
        name: "Trust level management"
        description: "Manage trust appropriately"
        control_ref: "AGENT-08"
        implementation: |
          - Risk-based operation classification
          - Dynamic trust threshold adjustment
          - User trust level management
          - Context-aware trust evaluation
      - id: "ASI09-M03"
        name: "Transparency requirements"
        description: "Ensure agent transparency"
        control_ref: "AGENT-08"
        implementation: |
          - Explainable agent actions
          - Traceable decision processes
          - Clear capability boundaries
          - Informed user consent
    cwes: ["CWE-754", "CWE-778"]
    capecs: ["CAPEC-98"]
    related_llm: ["LLM09"]
    related_controls: ["AGENT-08", "AGENT-06"]
    severity: "high"

  ASI10:
    id: "ASI10"
    name: "Rogue Agents"
    description: |
      Agents exhibiting behavioral deviation from intended objectives,
      including autonomous misalignment, goal drift, and emergent
      harmful behaviors that weren't explicitly programmed.
    stride_categories: ["elevation_of_privilege", "repudiation"]
    attack_vectors:
      - "Induced behavioral deviation"
      - "Goal drift over time"
      - "Emergent harmful behaviors"
      - "Autonomy boundary violations"
      - "Alignment degradation"
      - "Objective gaming"
    impacts:
      - "Unpredictable agent behavior"
      - "Unintended harmful actions"
      - "Loss of operational control"
      - "Trust system breakdown"
    mitigations:
      - id: "ASI10-M01"
        name: "Behavioral monitoring"
        description: "Continuous behavior analysis"
        control_ref: "AGENT-06"
        implementation: |
          - Establish behavioral baselines
          - Real-time deviation detection
          - Pattern recognition for anomalies
          - Drift trend monitoring
      - id: "ASI10-M02"
        name: "Autonomy boundaries"
        description: "Limit agent self-direction"
        control_ref: "AGENT-06"
        implementation: |
          - Define autonomy limits
          - Human confirmation thresholds
          - Dynamic autonomy adjustment
          - Emergency autonomy reduction
      - id: "ASI10-M03"
        name: "Rogue detection and response"
        description: "Detect and contain rogue behavior"
        control_ref: "AGENT-06"
        implementation: |
          - Malicious behavior pattern library
          - Behavior consistency checking
          - Goal deviation alerting
          - Automatic isolation mechanisms
    cwes: ["CWE-269", "CWE-250"]
    capecs: ["CAPEC-122"]
    related_llm: ["LLM08"]
    related_controls: ["AGENT-06", "AGENT-01"]
    severity: "critical"

# =============================================================================
# AGENT COMPONENT STRIDE MAPPINGS
# =============================================================================

agent_components:
  agent_core:
    type: "process"
    description: "Core agent orchestration and decision-making component"
    stride_threats:
      spoofing:
        - id: "AGENT-S-CORE-001"
          name: "Agent identity spoofing"
          description: "Attacker impersonates legitimate agent"
          mitigations: ["Agent authentication", "Identity verification", "Credential protection"]
          cwes: ["CWE-287"]
          control_ref: "AGENT-03"
      tampering:
        - id: "AGENT-T-CORE-001"
          name: "Goal manipulation"
          description: "Agent objectives altered by attacker"
          mitigations: ["Goal integrity verification", "Prompt signing", "Change detection"]
          cwes: ["CWE-94"]
          control_ref: "AGENT-01"
        - id: "AGENT-T-CORE-002"
          name: "Behavioral tampering"
          description: "Agent behavior modified through inputs"
          mitigations: ["Behavior monitoring", "Alignment checking", "Anomaly detection"]
          cwes: ["CWE-1321"]
          control_ref: "AGENT-06"
      repudiation:
        - id: "AGENT-R-CORE-001"
          name: "Unattributable actions"
          description: "Agent actions cannot be traced"
          mitigations: ["Comprehensive logging", "Decision audit trails", "Action attribution"]
          cwes: ["CWE-778"]
          control_ref: "AGENT-06"
      information_disclosure:
        - id: "AGENT-I-CORE-001"
          name: "Memory leakage"
          description: "Agent memory exposed to unauthorized parties"
          mitigations: ["Memory encryption", "Access controls", "Session isolation"]
          cwes: ["CWE-200"]
          control_ref: "AGENT-04"
      denial_of_service:
        - id: "AGENT-D-CORE-001"
          name: "Agent resource exhaustion"
          description: "Agent overwhelmed by malicious inputs"
          mitigations: ["Rate limiting", "Resource quotas", "Circuit breakers"]
          cwes: ["CWE-400"]
          control_ref: "AGENT-07"
      elevation_of_privilege:
        - id: "AGENT-E-CORE-001"
          name: "Goal hijack privilege escalation"
          description: "Attacker gains elevated access through goal manipulation"
          mitigations: ["Goal protection", "Action allowlists", "Human oversight"]
          cwes: ["CWE-269"]
          control_ref: "AGENT-01"

  mcp_server:
    type: "process"
    description: "Model Context Protocol server providing tools to agents"
    stride_threats:
      spoofing:
        - id: "AGENT-S-MCP-001"
          name: "MCP server impersonation"
          description: "Malicious server pretends to be legitimate"
          mitigations: ["Server authentication", "Certificate verification", "Source validation"]
          cwes: ["CWE-290"]
          control_ref: "AGENT-10"
      tampering:
        - id: "AGENT-T-MCP-001"
          name: "Tool response manipulation"
          description: "MCP server returns tampered tool outputs"
          mitigations: ["Response validation", "Output integrity checks", "Anomaly detection"]
          cwes: ["CWE-94"]
          control_ref: "AGENT-02"
        - id: "AGENT-T-MCP-002"
          name: "Tool capability inflation"
          description: "Tool claims more capabilities than declared"
          mitigations: ["Capability enforcement", "Runtime verification", "Behavior monitoring"]
          cwes: ["CWE-250"]
          control_ref: "AGENT-02"
      information_disclosure:
        - id: "AGENT-I-MCP-001"
          name: "Tool data exfiltration"
          description: "Sensitive data leaked through tool calls"
          mitigations: ["Data classification", "Output filtering", "Network monitoring"]
          cwes: ["CWE-200"]
          control_ref: "AGENT-02"
      elevation_of_privilege:
        - id: "AGENT-E-MCP-001"
          name: "Tool privilege abuse"
          description: "Tool used beyond intended scope"
          mitigations: ["Capability boundaries", "Permission enforcement", "Usage monitoring"]
          cwes: ["CWE-269"]
          control_ref: "AGENT-02"

  skill_template:
    type: "data_store"
    description: "Skill definitions and prompt templates"
    stride_threats:
      tampering:
        - id: "AGENT-T-SKILL-001"
          name: "Skill template poisoning"
          description: "Malicious content injected into skill definitions"
          mitigations: ["Template signing", "Version control", "Change approval"]
          cwes: ["CWE-506"]
          control_ref: "AGENT-09"
        - id: "AGENT-T-SKILL-002"
          name: "Prompt template injection"
          description: "Variable boundaries violated in templates"
          mitigations: ["Input/template separation", "Variable escaping", "Injection detection"]
          cwes: ["CWE-94"]
          control_ref: "AGENT-09"
      repudiation:
        - id: "AGENT-R-SKILL-001"
          name: "Template change attribution"
          description: "Cannot trace who modified templates"
          mitigations: ["Version control", "Change audit logs", "Author verification"]
          cwes: ["CWE-778"]
          control_ref: "AGENT-09"
      information_disclosure:
        - id: "AGENT-I-SKILL-001"
          name: "Sensitive template exposure"
          description: "Confidential skill templates leaked"
          mitigations: ["Template encryption", "Access controls", "Leakage detection"]
          cwes: ["CWE-200"]
          control_ref: "AGENT-09"

  agent_memory:
    type: "data_store"
    description: "Agent persistent memory and context storage"
    stride_threats:
      tampering:
        - id: "AGENT-T-MEM-001"
          name: "Memory poisoning"
          description: "Malicious content injected into agent memory"
          mitigations: ["Memory validation", "Integrity checks", "Anomaly detection"]
          cwes: ["CWE-1321"]
          control_ref: "AGENT-04"
        - id: "AGENT-T-MEM-002"
          name: "Context manipulation"
          description: "Historical context altered to influence behavior"
          mitigations: ["Context integrity", "Session verification", "History validation"]
          cwes: ["CWE-502"]
          control_ref: "AGENT-04"
      information_disclosure:
        - id: "AGENT-I-MEM-001"
          name: "Cross-session information leakage"
          description: "Data from one session exposed in another"
          mitigations: ["Session isolation", "Tenant separation", "Memory partitioning"]
          cwes: ["CWE-200"]
          control_ref: "AGENT-04"

  multi_agent_orchestrator:
    type: "process"
    description: "Multi-agent coordination and orchestration layer"
    stride_threats:
      spoofing:
        - id: "AGENT-S-ORCH-001"
          name: "Agent injection"
          description: "Malicious agent joins legitimate swarm"
          mitigations: ["Agent registration", "Identity verification", "Trust validation"]
          cwes: ["CWE-290"]
          control_ref: "AGENT-05"
      tampering:
        - id: "AGENT-T-ORCH-001"
          name: "Inter-agent message tampering"
          description: "Messages between agents modified"
          mitigations: ["Message signing", "Encryption", "Integrity verification"]
          cwes: ["CWE-319"]
          control_ref: "AGENT-05"
        - id: "AGENT-T-ORCH-002"
          name: "Orchestration logic manipulation"
          description: "Workflow coordination logic altered"
          mitigations: ["Workflow validation", "State verification", "Change detection"]
          cwes: ["CWE-94"]
          control_ref: "AGENT-05"
      denial_of_service:
        - id: "AGENT-D-ORCH-001"
          name: "Cascading failure"
          description: "Failure propagates across agent network"
          mitigations: ["Fault isolation", "Circuit breakers", "Graceful degradation"]
          cwes: ["CWE-400"]
          control_ref: "AGENT-07"
        - id: "AGENT-D-ORCH-002"
          name: "Deadlock induction"
          description: "Agents locked in circular dependency"
          mitigations: ["Deadlock detection", "Timeout controls", "Resource ordering"]
          cwes: ["CWE-833"]
          control_ref: "AGENT-07"

# =============================================================================
# AGENTIC ARCHITECTURE PATTERNS
# =============================================================================

architecture_patterns:
  single_agent_with_tools:
    name: "Single Agent with Tools"
    description: "Single agent with MCP/function calling capabilities"
    components:
      - "Agent Core"
      - "MCP Servers / Tool Registry"
      - "Tool Executors"
      - "Memory Store"
    trust_boundaries:
      - name: "User to Agent"
        type: "network"
        threats: ["Goal hijack", "Prompt injection", "Trust exploitation"]
      - name: "Agent to Tools"
        type: "process"
        threats: ["Tool misuse", "Privilege escalation", "Data exfiltration"]
      - name: "Tools to External Systems"
        type: "network"
        threats: ["Credential theft", "Data leakage", "RCE"]
    recommended_controls:
      - "AGENT-01: Goal protection"
      - "AGENT-02: Tool governance"
      - "AGENT-08: Human oversight"
      - "AGENT-04: Memory protection"

  multi_agent_collaboration:
    name: "Multi-Agent Collaboration"
    description: "Multiple agents working together on complex tasks"
    components:
      - "Orchestrator Agent"
      - "Specialist Agents"
      - "Communication Bus"
      - "Shared State Store"
    trust_boundaries:
      - name: "Agent to Agent"
        type: "process"
        threats: ["Agent impersonation", "Message tampering", "Trust propagation abuse"]
      - name: "Orchestrator Control"
        type: "process"
        threats: ["Orchestration manipulation", "Cascading failures"]
    recommended_controls:
      - "AGENT-05: Inter-agent communication security"
      - "AGENT-07: Cascading failure prevention"
      - "AGENT-03: Agent identity management"
      - "AGENT-06: Behavioral monitoring"

  skill_based_agent:
    name: "Skill-Based Agent"
    description: "Agent configured with custom skills and prompts"
    components:
      - "Agent Core"
      - "Skill Registry"
      - "Prompt Template Store"
      - "Skill Executor"
    trust_boundaries:
      - name: "Skill Loading"
        type: "data"
        threats: ["Skill poisoning", "Malicious prompts", "Supply chain"]
      - name: "Skill Execution"
        type: "process"
        threats: ["Skill abuse", "Capability escalation"]
    recommended_controls:
      - "AGENT-09: Prompt/Skill security"
      - "AGENT-10: Supply chain security"
      - "AGENT-02: Skill governance"

  autonomous_agent:
    name: "Autonomous Agent"
    description: "High-autonomy agent with minimal human oversight"
    components:
      - "Agent Core"
      - "Planning Module"
      - "Action Executor"
      - "Long-term Memory"
    trust_boundaries:
      - name: "Autonomy Boundary"
        type: "process"
        threats: ["Rogue behavior", "Goal drift", "Autonomy abuse"]
      - name: "Memory Persistence"
        type: "data"
        threats: ["Memory poisoning", "Context manipulation"]
    recommended_controls:
      - "AGENT-06: Behavioral monitoring (critical)"
      - "AGENT-08: Human trust boundaries (critical)"
      - "AGENT-01: Goal protection (critical)"
      - "AGENT-04: Memory security"

# =============================================================================
# MITRE ATLAS AGENTIC MAPPINGS
# =============================================================================

atlas_agentic_mappings:
  reconnaissance:
    - technique_id: "AML.T0000"
      name: "Agent Discovery"
      description: "Identify agent systems in target environment"
      related_asi: ["ASI04"]
      mitigations: ["Minimize agent exposure", "Hide agent capabilities"]

  initial_access:
    - technique_id: "AML.T0051.Agent"
      name: "Agent Goal Manipulation"
      description: "Inject malicious goals into agent system"
      related_asi: ["ASI01"]
      mitigations: ["Goal integrity", "Input validation"]

  ml_attack_staging:
    - technique_id: "AML.T0043.Agent"
      name: "Craft Agent Manipulation Data"
      description: "Create inputs to alter agent behavior"
      related_asi: ["ASI01", "ASI06"]
      mitigations: ["Input validation", "Behavior monitoring"]

  execution:
    - technique_id: "AML.T0Agent.001"
      name: "Tool Abuse"
      description: "Abuse agent tools for malicious purposes"
      related_asi: ["ASI02", "ASI05"]
      mitigations: ["Tool governance", "Sandboxing"]

  persistence:
    - technique_id: "AML.T0Agent.002"
      name: "Memory Persistence"
      description: "Persist malicious content in agent memory"
      related_asi: ["ASI06"]
      mitigations: ["Memory protection", "Integrity checks"]

  privilege_escalation:
    - technique_id: "AML.T0Agent.003"
      name: "Delegation Chain Abuse"
      description: "Escalate privileges through agent delegation"
      related_asi: ["ASI03"]
      mitigations: ["Delegation verification", "Least privilege"]

# =============================================================================
# COMPLIANCE MAPPINGS
# =============================================================================

compliance_mappings:
  nist_ai_rmf:
    framework: "NIST AI Risk Management Framework"
    version: "1.0"
    agentic_mappings:
      - function: "GOVERN"
        categories: ["Agentic governance", "Trust management"]
        relevant_asi: ["ASI09", "ASI10"]
        relevant_controls: ["AGENT-06", "AGENT-08"]
      - function: "MAP"
        categories: ["Agent risk identification", "Trust boundary mapping"]
        relevant_asi: ["ASI01", "ASI03", "ASI07"]
        relevant_controls: ["AGENT-01", "AGENT-03", "AGENT-05"]
      - function: "MEASURE"
        categories: ["Behavioral monitoring", "Alignment measurement"]
        relevant_asi: ["ASI06", "ASI10"]
        relevant_controls: ["AGENT-04", "AGENT-06"]
      - function: "MANAGE"
        categories: ["Agent control", "Failure management"]
        relevant_asi: ["ASI02", "ASI08"]
        relevant_controls: ["AGENT-02", "AGENT-07"]

  eu_ai_act:
    framework: "EU Artificial Intelligence Act"
    version: "2024"
    agentic_mappings:
      - risk_level: "High-Risk"
        requirements: ["Human oversight", "Transparency", "Robustness"]
        relevant_asi: ["ASI08", "ASI09", "ASI10"]
        relevant_controls: ["AGENT-06", "AGENT-07", "AGENT-08"]

  iso_42001:
    framework: "ISO/IEC 42001 AI Management System"
    version: "2023"
    agentic_mappings:
      - clause: "6.1"
        title: "Agentic risk management"
        relevant_controls: ["AGENT-01", "AGENT-06", "AGENT-07"]
      - clause: "8.4"
        title: "Agent development and deployment"
        relevant_controls: ["AGENT-02", "AGENT-09", "AGENT-10"]
